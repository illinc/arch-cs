\chapter{Использование ассемблерных вставок в~программах на C++}
\setlablabel{inline}
\purpose{научиться вставлять в~программы на языке высокого уровня ассемблерные фрагменты.
}


\begin{tasks}

% \item  Выполните программу с~примером, печатающим строку производителя процессора.


\item\footnote{Использованы: лабораторная работа, подготовленная Л.\,В.\,Илюшечкиной
}  

Разработайте и~выполните программу, в~которой реализуйте при помощи ассемблерной вставки
\bigskip
% \begin{itemize}
% \item для ПК 1, 5, 9, 13, 17, 21, 25: сложение целых чисел без знака;
% \itemдля ПК 2, 6, 10, 14, 18, 22, 26: сложение целых чисел со знаком;
% \itemдля ПК 3, 7, 11, 15, 19, 23: вычитание целых чисел без знака;
% \itemдля ПК 4, 8, 12, 16, 20, 24: вычитание целых чисел со знаком.
% \end{itemize}

\begin{variants}

Сложение целых чисел без знака
\next

Сложение целых чисел со знаком
\next

Вычитание целых чисел без знака
\next

Вычитание целых чисел со знаком
\next

Увеличение целого числа на 1 (инкремент)
\end{variants}


После команды сложения/вычитания проанализируйте соответствующий флаг состояния
процессора, и, в~зависимости от его значения, выведите результат и~строку «Результат верный»
(если не было переполнения) или «Результат неверный» (при переполнении).


\item %\bonus{+2 балла}
\labellocal{task:yx}
Реализуйте задание лабораторной работы \ref{lab:func} (см.\,раздел \ref{lab:func:tasks}, задание~\ref{lab:func:var}) как ассемблерную вставку в~программу на C++.

\item \bonus{+1 балл}
Реализуйте задание \reflocal{task:yx}, не используя в~тексте вставки конкретных имён регистров.

\item\bonus{+2 балла} 

\noindent 
Придумайте и~запишите в~отчёте:
\begin{itemize}
\item маску (т.е. второй операнд бинарной побитовой операции) для преобразования кодов ASCII~\cite{asciitable}
цифр '0'...'9' в~их двоичные эквиваленты (однобайтовые числа 0...9) с~помощью операции AND.
При этом ASCII-код нуля (шестнадцатеричное число \lstinline!0x30!, что также иногда записывается как $30_{16}$, однако наиболее предпочтительное и~самодокументирующееся представление ASCII-кода нуля "--- \lstinline!'0'!) должен быть преобразован в~однобайтовое число 00,  ASCII-код единицы (\lstinline!'1'!, шестнадцатеричное число \lstinline!0x31! или $31_{16}$)
 "--- в~01, и~т.\,д.;
\item необходимую операцию и~маску для преобразования однобайтовых чисел 0...9 в~их коды ASCII;
\item маску, которая преобразовывает строчные английские буквы в~прописные и~наоборот с~помощью операции XOR.
\end{itemize}
Коды ASCII приведены в~приложении~\ref{sec:ascii}.

Реализуйте преобразования ASCII-кодов цифр в~значения и~обратно как ассемблерную вставку в~программу на C++.


\end{tasks}


\theoryrefs
\theoryref{sec:cpp-types}
\theoryref{sec:asm-inline}
% \theoryref{sec:asm-flags}
\theoryref{sec:asm-commands}



% \pagebreak[4]

\section{Вопросы}
\begin{enumerate}
% \item Знаковой или беззнаковой является операция инкремента?
\item Каким ключевым словом открывается ассемблерная вставка?

\item Как из ассемблерной вставки обратиться к~локальным переменным?

\item Какие вы знаете ограничения на размещение параметров ассемблерных вставок?

\end{enumerate}



\section{Справочные материалы}
\begingroup
\lstset{keywordstyle=}

\begin{enumerate}

% \item
% Расширения файлов GCC "---
% C\'{e}dric Musso. Development with GNU/Linux.
% \lstinline!GCC and File Extensions - Development with GNU_Linux - labor-liber.html!

\item
Черновик стандарта C++ 
% (C++14 standard plus minor editorial changes) 
(C++14 с~незначительными редакторскими правками)
"---
November 2014 working draft.
\lstinline!n4296.pdf!


\item Список основных команд архитектур x86 и x86-64 "---
\lstinline!Команды архитектур x86 и x86-64.htm!


\end{enumerate}
\endgroup





