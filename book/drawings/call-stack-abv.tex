
\tikzstyle{blockarrow}	= [-latex',draw]
% \footnotesize
\scriptsize
% \tiny
\begin{tikzpicture}[
start chain=Mem going below,
% every on chain/.style=join,
% every on chain/.style=solidchaincell,
% every join/.style=blockarrow,
%	 	y and x
node distance=2ex and 2ex,
baseline=(current bounding box.north),
x = 30ex
]
\tikzstyle{block}	= [text width=9ex,text badly centered, minimum height=4ex, draw=black]

\tikzstyle{reg}	= [block,  fill=clRegisterLight, text width=5ex,]
\tikzstyle{mem}	= [block,  fill=clMemoryLight]
\tikzstyle{bigmem}	= [mem, minimum height=8ex ]


% \newcounter{figletter}
\setcounter{figletter}{1}


\foreach \sp in {0,1,1,0}
{
  \coordinate (sbottom) at (\arabic{figletter}, 0);
  \node[mem,solidchaincell, on chain=Mem, below=of sbottom] (s0) {$\ldots$};
  % \node[mem,solidchaincell,on chain=Mem]  {};

%   \node[mem,solidchaincell,on chain=Mem]  {};
  \xintifboolexpr{\sp > 0}
    {}
    {\tikzstyle{mem}	= [block]}
  ;    
  
  % https://tex.stackexchange.com/questions/294686/ifthenelse-inside-tikz-not-working
  % \pgfmathparse не работает
  % >= не работает
  
  \xintifboolexpr{\sp > 0}
    {\node[mem,solidchaincell,on chain=Mem] (s1) {$c_{i+1}$}}
    {\node[mem,solidchaincell,on chain=Mem] (s1) {}}
  ;  
%   \xintifboolexpr{\sp > 2}
%     {\node[mem,solidchaincell,on chain=Mem] (s3) {Данные fact(2)}}
%     {\tikzmath{\emptycells = \emptycells + 4;}}
%   ;  
  
  \tikzstyle{mem}	= [block]
  \node[mem,solidchaincell,on chain=Mem]  {};
  \node[mem,solidchaincell,on chain=Mem]  {$\ldots$};
\tikzstyle{mem}	= [block,  fill=clMemoryLight]
  \node[mem,solidchaincell,on chain=Mem, label=left:$f:$] (c2) {};
  \node[mem,solidchaincell,on chain=Mem]  {$\ldots$};
  \node[mem,solidchaincell,on chain=Mem] (c3)  {$ret$};
  \tikzstyle{mem}	= [block]
  
  \node[mem,solidchaincell,on chain=Mem]  {$\ldots$};
\tikzstyle{mem}	= [block,  fill=clMemoryLight]
  \node[mem,solidchaincell,on chain=Mem, %label=left:$c_{i-1}:$
    ]  {$\ldots$};
  \node[mem,solidchaincell,on chain=Mem, label=left:$c_{i}:$] (c1) {$call~f$};
  \node[mem,solidchaincell,on chain=Mem, label=left:$c_{i+1}:$] (c4) {};
 
  \node[reg, right= of s\sp]  (sp) {$sp$};
  \path[blockarrow] (sp) -- (s\sp);  
  
  \node[reg, right= of c\arabic{figletter}]  (ip) {$ip$};
  \path[blockarrow] (ip) -- (c\arabic{figletter});  

  \node[on chain=Mem]   {\normalfont\normalsize\small\asbuk{figletter})\stepcounter{figletter}};
}

\end{tikzpicture}