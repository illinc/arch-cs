
\chapter{Понятие вычислительной системы (ВС)}
\epigraph{\begin{stanza}
<<Вот где водится Снарк!>> "--- возгласил Балабон\\
Указав на вершину горы;\\
И~матросов на берег вытаскивал он,\\
Их подтягивал за вихры.\end{stanza}}
{\Snark}

\section{Терминология}
\epigraph{\begin{stanza}Так внемлите, друзья! Вам поведаю я\\Пять бесспорных и~точных примет,\\
По которым поймёте "--- если только найдёте, "---\\Кто попался вам "--- Снарк или нет.\end{stanza}}
{\Snark}

% Базовы
 
% http://infosys2006.narod.ru/struct/architec.htm
\termin{Архитектура системы}  в~стандарте ANSI/IEEE Std 1471-2000 (IEEE Recommended Practice for Architectural Description of Software-Intensive Systems) 
определяется как 
фундаментальная организация системы, реализованная в~её~компонентах, их~взаимоотношениях друг с~другом и~средой \\и~принципах, определяющих её~конструкцию (проектирование, дизайн) и~развитие~\cite{infosys2006.narod.ru}. 


\termin{Вычислительная система}, согласно Воройскому~\cite{voroiskij}, определяется двояко:
\begin{enumerate}
\item Совокупность ЭВМ и~средств программного обеспечения, предназначенная для выполнения вычислительных процессов.

\item Любая автоматизированная система, основанная на использовании ЭВМ.
\end{enumerate}


\termin{Автоматизированная система (АС) [automated system]}
% \termin{\insertsubsection{} \rlap{[automated system]}}

1.    Совокупность управляемого объекта и~автоматических управляющих устройств, в~которых часть функций управления выполняет человек-оператор.

2.    Комплекс технических, программных, др. средств и~персонала, предназначенный для автоматизации различных процессов. \\В отличие от автоматической системы не может функционировать без~участия человека.

\textterminblue{
Информатика. Новый систематизированный толковый словарь.    
\\
Воройский Ф.\,С.
}
\medskip

% Документация на \termin{автоматизированные системы (АС).}

% Согласно ГОСТ 34.003-90 Комплекс стандартов на автоматизированные системы. Автоматизированные системы. Термины и~определения,
% \termin{Автоматизированная система (АС)}
\termin{АС}
 "--- система, состоящая из персонала и~комплекса средств автоматизации его деятельности, реализующая информационную технологию выполнения установленных функций. \textterminblue{
ГОСТ 34.003-90}
 
% АС  \termin{не является ПО} в~чистом виде.

Таким образом, вычислительная система глобально может быть представлена как совокупность человека (оператора или программиста), технических средств (вычислительной машины, или компьютера% "--- computer, вычислитель
)
и~связывающих их программных средств.

Соответственно, архитектура вычислительной системы может быть описана двояко:
\begin{itemize}
\item структурная декомпозиция позволяет выделить компоненты 
% вычислительной системы, %(её программной и~аппаратной частей, а~также человека)
% и~описать их взаимодействие;
% в~том числе аппаратную составляющую "--- вычислительную машину, или компьютер, программную составляющую и~взаимодействующего с~ними человека;
вычислительной машины, в~том числе компоненты, предназначенные для хранения и~обработки программ
и~компоненты, взаимодействующие с~пользователем;
\item иерархическая декомпозиция описывает %взаимодействие вычислительной машины (компьютера) с~программным обеспечением и~с~человеком.
языки  взаимодействия программиста с~программ%ами и, опосредованно
ными и~техническими средствами системы. %, а~также .
\end{itemize}

\section{Структурная декомпозиция ВС}
\epigraph{\begin{stanza}[0mm]
Кура \\
дура \\
процедура \\
\hspace{\stanzaoddindent}состоит из трёх частей: \\
карбюратор \\
вентилятор \\
\hspace{\stanzaoddindent}и~коробка скоростей!\\
\end{stanza}}{Надпись на парте}

\begin{illustration}
\includegraphics[width=\approvedImageWidth]{arch-comp-struct}

\caption{Устройство компьютера}
\label{ris:arch-comp-struct}
\end{illustration}

\subsection{%Микроархитектура %процессора 
Структура
Intel 8008
и~Core2}

\begin{tabularx}{1\linewidth}{@{}l@{\,}l@{}}
% \includegraphics[width=0.7\linewidth,valign=c]{data-path}


\includegraphics[width=0.595\linewidth,keepaspectratio,valign=c]{Intel_8008_arch}\centering
&

\includegraphics[width=0.395\linewidth,keepaspectratio,valign=c]{Intel_Core2_arch}
\end{tabularx}






\subsection{Расположение программ и~данных}
% \begin{frame}{\insertsubsection}
% \footnotesize
% {
% \includegraphics[width=0.8\linewidth,valign=t]{Harvard-vonNeumann}\centering
% 
% }
% 
% Общая шина для памяти программ и~данных "--- узкое место архитектуры фон Неймана (принстонской)
% 
% \end{frame}

% \begingroup
% \tikzstyle{strokednode}	= [text badly centered, draw=black, thick, minimum height=4ex]
% \tikzstyle{block}	= [strokednode, text width=12ex]
% \newcommand{\UuAluBlock}[1]
% {
%   \tikzset{node distance=4ex}
%   \node[block] (#1Output)  at (#1) {Вывод};
%   \node[block, minimum height=8ex, above = of #1Output] (#1Alu) {АЛУ};
%   \node[block, above = of #1Alu] (#1Input) {Ввод};
% 
%   \node[strokednode, left = of #1Input, rotate=90, anchor=south] (#1Uu) {Управляющее устройство};
%   
%   \tikzset{node distance=0.5ex}
% }
\newcommand{\DoublearrowYRight}[2]
{
  \path[blockarrow] (#2) ++(0,0.5ex) coordinate(tmpUp) -- (tmpUp-|#1);
  \path[blockarrow] (#2-|#1)   ++(0,-0.5ex) coordinate(tmpDown) -- (tmpDown-|#2) ;
}

\resizebox{0.8\linewidth}{!}{
\begin{tikzpicture}[
node distance=2ex and 4ex,
baseline=(current bounding box.north)
]
\tikzstyle{strokednode}	= [text badly centered, draw=black, thick, minimum height=4ex]
\tikzstyle{block}	= [strokednode, text width=16ex]
\tikzstyle{blockarrow}	= [-latex', draw]
\tikzstyle{hiblock}	= [block, minimum height=8ex]

\coordinate (Pr);
% \UuAluBlock{Pr}

\coordinate[right = 40ex of Pr] (Gv);
% \UuAluBlock{Gv}

\foreach \i/\s in {Pr/Фон-неймановская (принстонская) архитектура, Gv/Гарвардская архитектура}
{
%   \tikzset{node distance=4ex}
  \node[block] ({\i}Output)  at (\i) {Вывод};
  \node[hiblock, above = of {\i}Output] ({\i}Alu) {АЛУ};
  \node[block, above = of {\i}Alu] ({\i}Input) {Ввод};

  \node[strokednode, left = of {\i}Input, rotate=90, anchor=south, inner xsep=1.5ex] ({\i}Uu) {Управляющее устройство};
  
  \path[blockarrow] ({\i}Input) -- ({\i}Alu);
  \path[blockarrow] ({\i}Alu) -- ({\i}Output);
  
  
  
%   \tikzset{node distance=0.5ex}
%   
%   \coordinate ({\i}UuLeft) at ({\i}Uu.south);
%   \path[blockarrow] ({\i}Alu.west) ++(0,0.5ex) coordinate({\i}AluUp) -- ({\i}AluUp-|{\i}UuLeft);
%   \path[blockarrow] ({\i}AluUp-|{\i}UuLeft)   ++(0,-1ex) coordinate({\i}AluDown) -- ({\i}AluDown-|{\i}Alu.west) ;
  \DoublearrowYRight{{\i}Uu.south}{{\i}Alu.west}
  
  \node[text width=40ex, text badly centered, below = of {\i}Output)] {\s};
}
  \node[hiblock, above = of {Pr}Input] (PrMemory) {Общая память};
  \DoublearrowYRight{{Pr}Uu.south}{PrMemory.west}
  \path[blockarrow] (PrMemory) -- ({Pr}Input);
  \path[blockarrow] ({Pr}Output.east) -- ++(4ex,0) |- (PrMemory);
  
\tikzstyle{narrowblock}	= [strokednode, text width=8ex]
%   \node[narrowblock, above = of {Gv}Input.north east] (GvDataMemory) {Память данных};
% %   \node[narrowblock, above = of {Gv}Input.north west|-GvDataMemory.north] (GvProgMemory) {Память команд};
%   \node[narrowblock, above = of {Gv}Input.north west|-GvDataMemory.north, anchor=west] (GvProgMemory) {Память команд};

  \coordinate[right= 5.5ex of {Gv}Input.north] (GvInputFromData);
  \coordinate[left= 5.5ex of {Gv}Input.north] (GvInputFromProg);
  \node[narrowblock, above = of GvInputFromData] (GvDataMemory) {Память данных};
  \node[narrowblock, above = of GvInputFromProg|-GvDataMemory] (GvProgMemory) {Память команд};

  \DoublearrowYRight{{Gv}Uu.south}{GvProgMemory.west}
  \DoublearrowYRight{{Gv}Uu.south}{GvDataMemory.west}
  \path[blockarrow] (GvProgMemory) -- (GvInputFromProg);
  \path[blockarrow] (GvDataMemory) -- (GvInputFromData);
  \path[blockarrow] ({Gv}Output.east) -- ++(4ex,0) |- (GvDataMemory);

\end{tikzpicture}
}


Общая шина для памяти программ и~данных "--- узкое место архитектуры фон Неймана






\subsection{Магистрали}
% \subsection{Макроархитектура}
% \subsection{Функциональная схема компьютера}
% \begin{frame}{\insertsubsection}
% \footnotesize
% {
% \includegraphics[height=\slideheigth,valign=t]{func-comp}\centering
% 
% }
% 
% \end{frame}


\resizebox{0.8\linewidth}{!}{
\input{book/fragments/arch-bus-controllers}
}
\subsection{Схема системной платы}

\includegraphics[width=\approvedImageWidth,valign=c]{Motherboard_diagram_ru}

\termin{Северный мост} "--- обмен между процессором и~скоростными устройствами,
частота шины, вид и~объём ОЗУ, тип шины видеоадаптера.
% \begin{itemize}
% \item память;
% \item шина PCI Express или AGP. 
% \end{itemize}

\termin{Южный мост} "--- часы, память CMOS,
работа с~низкоскоростными интерфейсами:
\begin{itemize} 
\item SATA, 
\item IDE, 
\item контроллер прерываний, 
\item USB, 
\item контроллер прямого доступа.
\end{itemize}

\subsection{Разделы памяти}

\begin{tabularx}{1\linewidth}{@{}LL@{}}
% \setlength{\parskip}{2ex}

\termin{.text} 

Код выполняемой программы
\bigskip

\termin{.data} 

Глобальные переменные программы
\bigskip

\termin{.bss}

Неинициализированные глобальные переменные
\bigskip
% .noinit 	Данные переменных программы 

Куча
(динамическая память)
\bigskip

Стек 
% Локальные переменные подпрограмм

&
Распределение памяти GNU/Linux

\includegraphics[width=\linewidth,keepaspectratio,valign=t]{linuxmem}\centering

\end{tabularx}

\subsection{Регистры x86}

Чем более объёмно запоминающее устройство, тем, как правило, медленнее оно работает.

Оперативная память обладает меньшей скоростью, чем процессор.
Хотя частоты работы как оперативной памяти, так и~процессора непрерывно растут, это соотношение сохраняется.

Соответственно, использование только данных, расположенных в памяти, сильно замедлило бы работу.

Частично обмен данными ускоряется при помощи кеширования.

Без задержек данные можно считать или сохранить из регистров.


 

\includegraphics[width=0.5\linewidth,keepaspectratio,valign=t]{Registers}

\begin{itemize}
\item {Регистры общего назначения} 
 \begin{itemize}
\item   \Reg{a, b, c, d;}  
\item    \Reg{si, di, bp;}
\item   {указатель стека} \Reg{sp}.
 \end{itemize}    
   
\item Сегментные %регистры 
  \Reg{cs, ds, ss, es, fs, gs.}

\item  Регистры состояния и~управления:
\begin{itemize}
\item   регистр флагов \Reg{eflags/flags};

\item       указатель команды \Reg{eip/ip}.
\end{itemize}   

\item   Регистры сопроцессора x87 \Reg{st(0)...st(7)}/расширения MMX \rlap{\Reg{mm0...mm7}}

\item        Регистры расширения XMM \rlap{(128-разрядные \Reg{xmm0...xmm7})}
\end{itemize}

% Также в~состав 

Регистры, специфичные для модели~\cite{intelModelSpecificRegisters}.


\subsection{Цикл выполнения команды}


\resizebox{0.7\linewidth}{!}{
\input{book/fragments/command-cycle}

}

\termin{Конвейер:}
\begin{itemize}
\item выборка и~декодирование инструкции
\item    загрузка данных
\item    выполнение инструкции
\item   запись результатов
\end{itemize}




\section{Иерархическая декомпозиция ВС}
% \epigraph{\begin{stanza}[0mm]
% Вот опять линяет краска,\\
% И~опять спадает маска,\\
% А~под ней "--- ещё одна,\\
% А~под ней "--- ещё одна,\\
% А~потом "--- ещё, ещё, ещё, ещё, ещё...\\
% \end{stanza}}{Юлий Ким}

\epigraph{
Вертикальная структура мирового древа складывалась из трёх частей, или уровней: нижнего (корни), среднего (ствол) и~верхнего (ветви)%.
...\\ 
% Так сформировались в~воображении древних основные космические зоны, а~с~ними и~сдвоенные противоположности: Земля "--- Небо, Земля "--- Преисподняя, огонь (сухое) "--- влага (мокрое), прошлое "--- настоящее, настоящее "--- будущее, день "--- ночь. Эти пары перемещались в~структуре древа с~троичными единствами: прошлое "--- настоящее "--- будущее; предки "--- современники "--- потомки; три части тела: голова "--- туловище "--- ноги; три стихии: огонь "--- вода "--- земля. Пары и~тройки обнимали самые разнообразные формы жизни. 
Люди постигали взаимосвязь противоположностей, суть всякого развития.
}{Г.\,Белякова}

% В~соответствии 

Согласно Таненбауму~\cite{tanenbaum-arch}, вычислительную систему можно представить в~виде ряда уровней абстракции.

\includegraphics[width=\approvedImageWidth,valign=t]{multi-level-abstract}



\includegraphics[width=\approvedImageWidth,valign=c]{multi-level-asm}


\includegraphics[width=\approvedImageWidth,valign=c]{Layered_computer_structure}


\section{История} 
\epigraph{\begin{stanza}[0mm]Действительность "--- не бред собачий.\\
Она сложнее и~богаче.\end{stanza}}
{Валентин Берестов}

Современные ВС: 6 уровней; как отрастали эти шесть уровней, начиная от одноуровневых счётов и~одно?двух?уровневого жаккардова станка

\subsection{Развитие вычислительной техники}

1938 "--- механическая счётная машина Z1 Конрада Цузе, Германия, была использована уже двоичная система счисления.
Для ввода-вывода данные преобразовывались в~десятичный вид.

1939 "--- усовершенствованный вариант вычислителя Цузе, Z2 на основе телеграфных реле.

1941 "--- Z3

% http://wiki.livid.pp.ru/students/cs/lectures/1.html
% В~механической счётной машине Z1 Конрада Цузе (1938 г.) была использована уже двоичная система счисления.
% Это позволило существенно уменьшить размеры устройства.
% Усовершенствованный вариант вычислителя Цузе, Z2 на основе телеграфных реле (1939),  закрепил использование двоичной логики.



1943 "--- ЭНИАК (ENIAC, Electronic Numerical Integrator and Computer) на  вакуумных лампах и десятичной СС
% 
% Реле может находиться только в~двух состояниях "--- оно открыто либо закрыто.
% Именно в~электромеханическом реле в~Mark II (1946), согласно легенде, был обнаружен первый баг.

1943--1950 "--- Z4 на реле, первый ЯВУ



\colorlet{csArch}{orange!70!black}
\newcommand{\terminModel}[1]{{\textcolor{csArch}{#1}}}
\newcommand{\terminComment}[1]{{\textcolor{gray}{#1}}}

\subsection{Поколения процессоров Intel}

\begin{tabularx}{1\linewidth}{@{}l@{~}L@{}}

\termin{4-битные:}& 4004, 4040\\

\termin{8-битные:}& 8008, 8080 \terminComment{(адрес "--- %16 или 
14),} 8085 \terminComment{(частота "--- 5 МГц)}\\

\termin{16-битные:}& \termin{8086} \terminComment{(адрес "--- 20, \termin{слово "--- 16 бит}, %отдельный 
FPU 8087),} 8088 \rlap{\terminComment{(8 бит),}}\\
&80186, 80188,\\
&80286 \terminComment{(адрес "--- 24)}\\
\termin{32-битные:}& \textcolor{colorRegister}{
iAPX 432 %, 80960, 80860, 
"--- не x86-совместим
}
\\
&80386DX, 80386SX\\
&80486DX \terminComment{(встроенный FPU),} 80486SX\\
\end{tabularx}

\begin{tabularx}{1\linewidth}{@{}l@{}L@{}}
&Pentium (P5, P54, P54C, \terminComment{данные "--- 64}), Pentium MMX\\
&Pentium Pro, Pentium II \terminModel{(Klamath, Deschutes)}, Celeron \terminModel{(Covington, Mendocino)},\\
&Pentium III (SSE, \terminModel{Katmai, Coppermine, Tualatin}), Celeron \terminModel{(Coppermine, Tualatin)}...\\
\end{tabularx}
\\
\includegraphics[width=1\linewidth,keepaspectratio,valign=t]{IntelProcessorRoadmap}








\section{Связь уровней}


\epigraph{
Вертикальная структура древа больше связана с~космологией, а~горизонтальная "--- с~магическими ритуалами. Чаще всего древо изображалось с~восемью ветвями, по четыре с~каждой стороны. Имело оно и~четыре главных цвета: красный, черный, белый, синий.}{Г.\,Белякова}

в~том числе компиляция и~интерпретация

\nsection{Контрольные вопросы}

\begin{enumerate}
% \item Какова цель курса?

\item Что включает архитектура системы?
\item Что такое вычислительная система?

\item Какие вы знаете единицы измерения информации?


% \item Какие способы представления знаковых чисел используются в~ЭВМ?
% \item Какие логические и~битовые операции вы~знаете?

\item Какие вы знаете компоненты ЭВМ?


\item Чем отличаются фон-Неймановская и~гарвардская архитектуры?

\item Из чего состоит системная шина (магистраль)?

\item Какие вы знаете основные виды регистров \rlap{x86?}

\item Как используется регистр ip?

\item Как используется регистр sp?
\end{enumerate}
