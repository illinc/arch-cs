
\chapter{Краткий обзор уровней современной ВС }

\epigraph{
 К~каждой из трёх частей древа относились определенные существа. Вверху, на ветвях изображали птиц, посередине, у~ствола "--- копытных (оленей, лосей, коров, лошадей), иногда человека и~пчёл, а~у~корней "--- змей, лягушек, рыб и~бобров. 
%  Бог восседал на самой верхушке древа. Иногда он вступал в~битву со змеем или драконом и~освобождал похищенный ими скот. Древо, символизировавшее зачатие и~плодородие, изображали на женских одеждах.
 }{Г.\,Белякова}

кратко! Дальше часть того же самого подробнее

\section{Цифровой логический уровень}

\epigraph{
Но да будет слово ваше: «да, да»; «нет, нет»; а~что сверх этого, то от лукавого.
}{Мф. 5:37}

сигналы и~вентили, 0 и~1, триггер как элементарная ячейка памяти, полусумматор, однобитовый сумматор


Сигналы и~вентили

\newcolumntype{Y}{>{$}C<{$}}
\newcolumntype{Z}{>{\columncolor{csMarker}}Y}
\begin{tabularx}{1\linewidth}{YY|YZZ|YYY}
a 	&	b &	\lnot a 	&	\overline{a \land b} 	&	\overline{a \lor b} & a \land b 	&	a \lor b & a \oplus b\\\hline
0 	&	0 	&\multirow{2}{*}{$1$}&	1         	&	1         &0         	&	0         &	0\\
0 	&	1 	&		&	1         	&	0         &0         	&	1         &	1\\\hline
1 	&	0 	&\multirow{2}{*}{$0$}&	1         	&	0         &0         	&	1         &	1\\
1 	&	1 	&		&	0         	&	0         &1         	&	1         &	0\\\hline
\end{tabularx}

\termin{Бит} "--- двоичный разряд (одно состояние).%\raggedright

% \tikz\node [and gate] {};

\includegraphics[width=0.8\linewidth,valign=t]{Logic-gate-index}



\section{Микроархитектурный уровень}
% \epigraph{
% \begin{stanza}[0mm]
% И~орел не взмахивал крылами, \\
% Звёзды жались в~ужасе к~луне, \\
% Если, точно розовое пламя, \\
% Слово проплывало в~вышине.
% \end{stanza}
% }{Н.\,C.\,Гумилёв}
\epigraph{\begin{limerick}
Говорят, в~самом сердце Тибета\\
в~страшной тайне содержится
Это.\\
Но есть мнение, что\\
Это "--- вовсе не То;\\
ничего даже общего где-то.\\
\end{limerick}
}
{С.\,Сатин}


регистр, байт, октет, слово



% Микроархитектура МП – это 
\begin{itemize}
\item аппаратная организация и~логическая структура МП;
\item регистры;
\item управляющие схемы; % (УУ), 
\item арифметико-логические устройства (АЛУ); 
\item запоминающие устройства; 
\item %и~
связывающие их информационные магистрали \rlap{(шины).}
\end{itemize}

% % Шины и~элементы (регистры,  арифметико-логические устройства (АЛУ) и~т.\,д.)
% % \medskip
% % 
% % \termin{Конвейер:}
% % \setlistspacing{1}{0ex}
% % \begin{itemize}
% % \item 
% %     чтение и~декодирование инструкции
% %     
% % \item    загрузка данных
% %     
% % \item    выполнение инструкции
% %     
% %  \item   запись результатов
% % \end{itemize}
% % \medskip
% % 
% % \termin{Тракт данных:}
% % \begin{itemize}
% % \item локальная память
% % % \rlap
% % {(набор регистров);}
% % 
% % \item АЛУ.
% % % арифметико-логическое устройство (АЛУ).
% % \end{itemize}


% \end{tabularx}

\termin{Машинное слово}  "--- разрядность шины данных/регистра.

\termin{Байт} "--- %совокупность битов, обрабатываемая компьютером одномоментно (обычно байт=октет).
минимальный независимо адресуемый \rlap{набор данных.}

\termin{Октет} "--- 8 бит ($2^8 = 256$ состояний).


% Машинное \termin{слово}  "--- разрядность регистров процессора и/или шины данных.



\section{Уровень архитектуры команд}
\epigraph{
\begin{stanza}
Ведь очень скоро у~меня будет Это \\
и~я~буду ясно знать, что с~Этим делать.\\
\end{stanza}
}{\Aquarium}

память, адресация, указатель, команды

\newcommand{\grayemph}[1]{\textcolor{gray}{\emph{#1}}} 

\begin{itemize}
\item    архитектура памяти;
\item    взаимодействие с~внешними устройствами ввода/вывода;
\item    режимы адресации;
\item    регистры;
\item    машинные команды
\begin{itemize}
\item    CISC \grayemph{(complex instruction set computer);}
\item    RISC \grayemph{(reduced instruction set computer, %архитектуры 
load/store);}
\item    VLIW \grayemph{(very long instruction word),} суперскалярные;
\end{itemize}
\item    различные типы внутренних данных (целочисленные, с~плавающей запятой и~т.\,д.);
\item   обработчики прерываний и~исключений.
\end{itemize}

\subsection{Структура команды x86}
\includegraphics[width=1\linewidth,keepaspectratio,valign=t]{cmd_structure}

\subsection{Методы адресации}


\begin{enumerate}
\item \termin{Непосредственная} "--- константа
\item \termin{Прямая} (абсолютная) "--- переменная в~памяти по~фиксированному адресу (статическая)
\item \termin{Регистровая} "--- переменная в~регистре
\item \termin{Косвенно-регистровая (косвенная)} "--- указатель в~регистре
$$
\text{Адрес} = \Reg{Base} + 2^{Scale} \cdot \Reg{Index} + Disp
$$
$\Reg{Base}$ и~$\Reg{Index}$ "--- регистры, $Disp$ "--- смещение (константа)
\end{enumerate}



\subsection{Стек}

\resizebox{1\linewidth}{!}{
\input{book/fragments/stack}
}


\subsection{Порядок следования байтов в~словах}


\begin{tabularx}{1\linewidth}{@{}LL@{}}
\termin{Прямой} (little-endian, Intel, VAX) & \termin{Обратный} (big-endian, Motorola) \\
младший байт слова 
по~младшему адресу
&
младший байт слова 
по~старшему адресу
\\[1ex]
% % \multicolumn{2}{K{0.9\linewidth}}{Число  FE 0A 91 87 в~двойном слове по адресу 0 будет выглядеть в~памяти как}
% \multicolumn{2}{c}{\termin{\texttt{FE 0A 91 87} по адресу~0:}}
% % \multicolumn{2}{c}{ff}
% \\
% \renewcommand{\arraystretch}{1}
% \begin{tabular}{@{}lr@{~}r@{~}r@{~}r@{}}
% &87&91&0A&FE\\
% № байта  &0      &1       &2      &3
% \end{tabular}
% &
% \renewcommand{\arraystretch}{1}
% \begin{tabular}{@{}lr@{~}r@{~}r@{~}r@{}}
% &FE&0A&91&87\\
% № байта  &0      &1       &2      &3
% \end{tabular}
% \multicolumn{2}{c}{\termin{\texttt{0A 0B 0C 0D} по адресу~0:}}
\multicolumn{2}{c}{\termin{\texttt{0x\,0A\,0B\,0C\,0D} по адресу~0:}}
% \multicolumn{2}{c}{ff}
\\
\renewcommand{\arraystretch}{1}
\begin{tabular}{@{}lr@{~}r@{~}r@{~}r@{}}
&0D&0C&0B&0A\\
№ байта  &0      &1       &2      &3
\end{tabular}
&
\renewcommand{\arraystretch}{1}
\begin{tabular}{@{}lr@{~}r@{~}r@{~}r@{}}
&0A&0B&0C&0D\\
№ байта  &0      &1       &2      &3
\end{tabular}
\end{tabularx}

\termin{Переключаемый} (bi-endian, bytesexual)

\termin{Смешанный} (middle-endian, mixed-endian) %"--- машинные слова от старшего к~младшему.
\begin{tabularx}{1\linewidth}{@{}LL@{}}
\renewcommand{\arraystretch}{1}
\begin{tabular}{@{}lr@{~}r@{~}r@{~}r@{}}
PDP-11&0B&0A&0D&0C\\
№ байта  &0      &1       &2      &3
\end{tabular}
&
\begin{tabular}{@{}lr@{~}r@{~}r@{~}r@{}}
&0C&0D&0A&0B\\
№ байта  &0      &1       &2      &3
\end{tabular}
\end{tabularx}



\section{Уровень операционной системы}
\epigraph{
\begin{stanza}
Гора Крукенберг\\
На реке Оккервиль;\\
Река Оккервиль\\
Под горой Крукенберг.\\
\end{stanza}
}{\Aquarium}

управление памятью, загрузка и~выполнение программ, системные вызовы, доступ к~устройствам


\section{Уровень ассемблера}
\epigraph{
\begin{stanza}
Я~прочёл об этом в~старинных трактатах, \\
прочёл и~сразу ушел из деревни;\\
Скоро я~буду баснословно богатым \\
и~смогу претворить в~жизнь учения древних.\\
\end{stanza}
}{\Aquarium}

мнемоники, ассемблирование, ассемблеры

Разным процессорам соответствуют разные языки ассемблера.

Разные компиляторы также поддерживают разный синтаксис.

\section{Языки высокого уровня}
\epigraph{
\begin{stanza}
Я~буду жить в~доме из костей земли \\
и~с~большой дороги будут заходить дети\\
Чтобы любоваться на мои кристаллы, \\
сияющие во фрактальном свете.\\
\end{stanza}
}{\Aquarium}

языки, компиляторы, GCC


\nsection{Контрольные вопросы}
